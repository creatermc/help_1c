&НаСервереБезКонтекста
Функция УдалитьВсеИспользованиеТранзакций(МассивУдаляемых, МассивНессылочныхОбъектов)
			
	Попытка
		
		НачатьТранзакцию();
		КоличествоОбъектов = МассивНессылочныхОбъектов.Количество();
		Для Каждого НессылочныйОбъект Из МассивНессылочныхОбъектов Цикл	
			ИмяРегистра = Метаданные.НайтиПоТипу(ТипЗнч(НессылочныйОбъект)).Имя;
			МенеджерЗаписи = РегистрыСведений[ИмяРегистра].СоздатьМенеджерЗаписи();
			ЗаполнитьЗначенияСвойств(МенеджерЗаписи, НессылочныйОбъект);
			МенеджерЗаписи.Удалить(); 
		КонецЦикла;
		
		Если МассивУдаляемых.Количество() Тогда
			УдалитьЭлементы(МассивУдаляемых);
			КоличествоОбъектов = КоличествоОбъектов + МассивУдаляемых.Количество();
		КонецЕсли;
		
		ЗафиксироватьТранзакцию();
				
	Исключение
		
		КоличествоОбъектов = 0;
		
		Если ТранзакцияАктивна() Тогда		
			ОтменитьТранзакцию();	
		КонецЕсли;
		
		ИТ_ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки());			
		
	КонецПопытки;
	
	Возврат КоличествоОбъектов;
	
КонецФункции

получить одну запись на период 

выбрать ваксимальную по дате отсортировать по убыванию и выбрать первую 

				
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	яя_ВыводСотрудниковСрезПоследних.Организация КАК Организация,
	яя_ВыводСотрудниковСрезПоследних.ОрганизацияРекрутера КАК ОрганизацияРекрутера
ПОМЕСТИТЬ ВТ_ДляОтбора
ИЗ
	РегистрСведений.яя_ВыводСотрудников.СрезПоследних(
			,
			Регистратор = &ВыводСотрудников
				И УспешноеПрохождениеИС
				И НЕ Организация = ОрганизацияРекрутера) КАК яя_ВыводСотрудниковСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	МАКСИМУМ(ДоговорыМеждуОрганизациями.Ссылка) КАК Ссылка,
	ДоговорыМеждуОрганизациями.ОрганизацияПолучатель КАК ОрганизацияПолучатель,
	МАКСИМУМ(ДоговорыМеждуОрганизациями.ДатаНачалаДействия) КАК ДатаНачалаДействия
ИЗ
	ВТ_ДляОтбора КАК ВТ_ДляОтбора
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыМеждуОрганизациями КАК ДоговорыМеждуОрганизациями
		ПО ВТ_ДляОтбора.Организация = ДоговорыМеждуОрганизациями.ОрганизацияПолучатель
			И ВТ_ДляОтбора.ОрганизацияРекрутера = ДоговорыМеждуОрганизациями.Организация
ГДЕ
	НЕ ДоговорыМеждуОрганизациями.ПометкаУдаления
	И ДоговорыМеждуОрганизациями.Наименование ПОДОБНО "%Подбор%"
	И ДоговорыМеждуОрганизациями.ДатаНачалаДействия <= &ДатаДействия

СГРУППИРОВАТЬ ПО
	ДоговорыМеждуОрганизациями.ОрганизацияПолучатель

						
///////////////////////////////////////////////////////////////////////////

другой вариант общий 
				
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	яя_ВыводСотрудниковСрезПоследних.Организация КАК Организация,
	яя_ВыводСотрудниковСрезПоследних.ОрганизацияРекрутера КАК ОрганизацияРекрутера
ПОМЕСТИТЬ ВТ_ДляОтбора
ИЗ
	РегистрСведений.яя_ВыводСотрудников.СрезПоследних(
			,
			Регистратор = &ВыводСотрудников
				И УспешноеПрохождениеИС
				И НЕ Организация = ОрганизацияРекрутера) КАК яя_ВыводСотрудниковСрезПоследних
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ДоговорыМеждуОрганизациями.Ссылка КАК Ссылка,
	ДоговорыМеждуОрганизациями.ОрганизацияПолучатель КАК ОрганизацияПолучатель,
	ДоговорыМеждуОрганизациями.ДатаНачалаДействия КАК ДатаНачалаДействия
ПОМЕСТИТЬ ВТ_Договоры
ИЗ
	ВТ_ДляОтбора КАК ВТ_ДляОтбора
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.ДоговорыМеждуОрганизациями КАК ДоговорыМеждуОрганизациями
		ПО ВТ_ДляОтбора.Организация = ДоговорыМеждуОрганизациями.ОрганизацияПолучатель
			И ВТ_ДляОтбора.ОрганизацияРекрутера = ДоговорыМеждуОрганизациями.Организация
ГДЕ
	НЕ ДоговорыМеждуОрганизациями.ПометкаУдаления
	И ДоговорыМеждуОрганизациями.Наименование ПОДОБНО "%Подбор%"
	И ДоговорыМеждуОрганизациями.ДатаНачалаДействия <= &ДатаДействия
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВТ_Договоры.Ссылка КАК Ссылка
ИЗ
	ВТ_Договоры КАК ВТ_Договоры
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ
			ВТ_Договоры.ОрганизацияПолучатель КАК ОрганизацияПолучатель,
			МАКСИМУМ(ВТ_Договоры.ДатаНачалаДействия) КАК МаксДатаНачалаДействия
		ИЗ
			ВТ_Договоры КАК ВТ_Договоры
		
		СГРУППИРОВАТЬ ПО
			ВТ_Договоры.ОрганизацияПолучатель) КАК ВложенныйЗапрос
		ПО ВТ_Договоры.ОрганизацияПолучатель = ВложенныйЗапрос.ОрганизацияПолучатель
			И ВТ_Договоры.ДатаНачалаДействия = ВложенныйЗапрос.МаксДатаНачалаДействия

СГРУППИРОВАТЬ ПО
	ВТ_Договоры.Ссылка
